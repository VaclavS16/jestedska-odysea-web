---
import BaseLayout from "../../layouts/BaseLayout.astro";
import JoBand from "../../components/JoBand.astro";
import JoProgram from "../../components/JoProgram.astro";
import programData from "../../content/program.json";
import type { JoBand as BandType } from "../../types/content";
import { toBandSlug } from "../../utils/program";

const bands = programData as BandType[];
const uniqueBands = new Map<string, BandType>();
for (const band of bands) {
  uniqueBands.set(toBandSlug(band), band);
}

export function getStaticPaths() {
  return [...uniqueBands.keys()].map((slug) => ({ params: { band: slug } }));
}

const { band } = Astro.params;
const activeBandSlug = typeof band === "string" ? band : "";
const activeBand = uniqueBands.get(activeBandSlug);

const description = "Ještědská odysea je multižánrový hudební a kulturní festival, jenž se koná v Liberci.";
---

<BaseLayout
  title={`${activeBand?.name || "Program"} | Program | Ještědská odysea`}
  description={description}
  currentPath="/program"
>
  <div>
    <JoProgram activeBandSlug={activeBandSlug} />
    <JoBand activeBandSlug={activeBandSlug} />
  </div>
</BaseLayout>
